<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="java多线程, 十二の博客宇宙"><meta name="description" content="Java多线程1、什么是多线程？指在软件或者硬件中同一时间并行实现多个线程并发执行的技术（即在一个程序中运行多个不同的线程来执行不同的任务）

2、他有什么作用？优缺点有哪些？作用：　
（1）在单核CPU中，将CPU分为很小的时间片，在每一"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="referrer" content="no-referrer-when-downgrade"><title>java多线程 | 十二の博客宇宙</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload='"all"!=media&&(media="all")'><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" type="text/css" href="/css/reward.css"><script src="/libs/jquery/jquery-3.6.0.min.js"></script><meta name="generator" content="Hexo 6.3.0"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="十二の博客宇宙" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><style type="text/css" lang="css">#loading-container{position:fixed;top:0;left:0;min-height:100vh;width:100vw;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;background:#fff;text-align:center;-webkit-transition:opacity 1s ease;-moz-transition:opacity 1s ease;-o-transition:opacity 1s ease;transition:opacity 1s ease}.loading-image{width:120px;height:50px;transform:translate(-50%)}.loading-image div:nth-child(2){-webkit-animation:pacman-balls 1s linear 0s infinite;animation:pacman-balls 1s linear 0s infinite}.loading-image div:nth-child(3){-webkit-animation:pacman-balls 1s linear .33s infinite;animation:pacman-balls 1s linear .33s infinite}.loading-image div:nth-child(4){-webkit-animation:pacman-balls 1s linear .66s infinite;animation:pacman-balls 1s linear .66s infinite}.loading-image div:nth-child(5){-webkit-animation:pacman-balls 1s linear .99s infinite;animation:pacman-balls 1s linear .99s infinite}.loading-image div:first-of-type{width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_up .5s 0s infinite;animation:rotate_pacman_half_up .5s 0s infinite}.loading-image div:nth-child(2){width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_down .5s 0s infinite;animation:rotate_pacman_half_down .5s 0s infinite;margin-top:-50px}@-webkit-keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@-webkit-keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@-webkit-keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}@keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}.loading-image div:nth-child(3),.loading-image div:nth-child(4),.loading-image div:nth-child(5),.loading-image div:nth-child(6){background-color:#49b1f5;width:15px;height:15px;border-radius:100%;margin:2px;width:10px;height:10px;position:absolute;transform:translateY(-6.25px);top:25px;left:100px}.loading-text{margin-bottom:20vh;text-align:center;color:#2c3e50;font-size:2rem;box-sizing:border-box;padding:0 10px;text-shadow:0 2px 10px rgba(0,0,0,.2)}@media only screen and (max-width:500px){.loading-text{font-size:1.5rem}}.fadeout{opacity:0}@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}@keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0)}}</style><script>setTimeout(function(){const e=document.getElementById("loading-container");e.className="fadeout",setTimeout(function(){e.style.display="none"},2500)},1e3)</script><body><div id="loading-container"><p class="loading-text">嘘~ 正在从服务器偷取页面 . . .</p><div class="loading-image"><div></div><div></div><div></div><div></div><div></div></div></div><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><div><img src="/medias/loading.gif" data-original="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">十二の博客宇宙</span></div></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><span>统计</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/tags"><i class="fas fa-tags" style="margin-top:-20px;zoom:.6"></i> <span>标签</span></a></li><li><a href="/categories"><i class="fas fa-bookmark" style="margin-top:-20px;zoom:.6"></i> <span>分类</span></a></li><li><a href="/archives"><i class="fas fa-archive" style="margin-top:-20px;zoom:.6"></i> <span>归档</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-list" style="zoom:.6"></i> <span>娱乐</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/movies"><i class="fas fa-film" style="margin-top:-20px;zoom:.6"></i> <span>电影</span></a></li><li><a href="/books"><i class="fas fa-book" style="margin-top:-20px;zoom:.6"></i> <span>读书</span></a></li><li><a href="/games"><i class="fas fa-gamepad" style="margin-top:-20px;zoom:.6"></i> <span>游戏</span></a></li><li><a href="/bangumis"><i class="fas fa-film" style="margin-top:-20px;zoom:.6"></i> <span>番剧</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>留言板</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/artitalk" class="waves-effect waves-light"><i class="fas fa-comment" style="zoom:.6"></i> <span>说说</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li><li><a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式"><i id="sum-moon-icon" class="fas fa-sun" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/loading.gif" data-original="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">十二の博客宇宙</div><div class="logo-desc">许多时候，称谓并不重要，重要的是对方一直在那个位置上，从未被挪动。</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fas fa-fw fa-link"></i> 统计 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/tags" style="margin-left:75px"><i class="fa fas fa-tags" style="position:absolute;left:50px"></i> <span>标签</span></a></li><li><a href="/categories" style="margin-left:75px"><i class="fa fas fa-bookmark" style="position:absolute;left:50px"></i> <span>分类</span></a></li><li><a href="/archives" style="margin-left:75px"><i class="fa fas fa-archive" style="position:absolute;left:50px"></i> <span>归档</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-list"></i> 娱乐 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/movies" style="margin-left:75px"><i class="fa fas fa-film" style="position:absolute;left:50px"></i> <span>电影</span></a></li><li><a href="/books" style="margin-left:75px"><i class="fa fas fa-book" style="position:absolute;left:50px"></i> <span>读书</span></a></li><li><a href="/games" style="margin-left:75px"><i class="fa fas fa-gamepad" style="position:absolute;left:50px"></i> <span>游戏</span></a></li><li><a href="/bangumis" style="margin-left:75px"><i class="fa fas fa-film" style="position:absolute;left:50px"></i> <span>番剧</span></a></li></ul></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言板</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li class="m-nav-item"><a href="/artitalk" class="waves-effect waves-light"><i class="fa-fw fas fa-comment"></i> 说说</a></li><li><div class="divider"></div></li><li><a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/1.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">java多线程</h1></div></div></div></div></div><main class="post-container content"><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="chip bg-color">多线程</span></a></div></div><div class="col s5 right-align"></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2024-03-04</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp; 2024-03-06</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 6.1k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp; 22 分</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h2 id="Java多线程"><a href="#Java多线程" class="headerlink" title="Java多线程"></a>Java多线程</h2><h5 id="1、什么是多线程？"><a href="#1、什么是多线程？" class="headerlink" title="1、什么是多线程？"></a>1、什么是多线程？</h5><p>指在软件或者硬件中同一时间并行实现多个线程并发执行的技术（即在一个程序中运行多个不同的线程来执行不同的任务）</p><hr><h5 id="2、他有什么作用？优缺点有哪些？"><a href="#2、他有什么作用？优缺点有哪些？" class="headerlink" title="2、他有什么作用？优缺点有哪些？"></a>2、他有什么作用？优缺点有哪些？</h5><p><strong>作用：</strong>　</p><p>（1）在单核CPU中，将CPU分为很小的时间片，在每一时刻只能有一个线程在执行，是一种微观上轮流占用CPU的机制。由于CPU轮询的速度非常快，所以看起来像是“同时”在执行一样。多线程会存在线程上下文切换，会导致程序执行速度变慢;</p><p>（2）多线程不会提高程序的执行速度，反而会降低速度。但是对于用户来说，可以减少用户的等待响应时间，提高了资源的利用效率。</p><p>（3）多线程并发利用了CPU轮询时间片的特点，在一个线程进入阻塞状态时，可以快速切换到其余线程执行其余操作，这有利于提高资源的利用率，限度的利用系统提供的处理能力，有效减少了用户的等待响应时间。</p><p>（4）便于建模，这是另外个没有这么明显的优点了。假设有一个大的任务A，单线程编程，那么就要考虑很多，建立整个程序模型比较麻烦。但是如果把这个大的任务A分解成几个小任务，任务B、任务C、任务D，分别建立程序模型，并通过多线程分别运行这几个任务，那就简单很多了。</p><p><strong>优点：</strong></p><ol><li>提高性能：现在计算机绝大多数拥有多核处理器，多线程技术可以充分利用多个核心，同时执行多个不同的任务，大大提升了程序的吞吐率和运行速度；</li><li>共享资源：多个线程可以共享同一进程的内存空间，从而实现线程之间的资源共享；</li><li>并发处理：多线程允许程序同时处理多个任务，从而更加快速有效的处理并发请求、消息和数据；</li><li>异步编程：多线程可用于实现异步编程模型，通过在后台执行任务来提高程序的执行效率；</li><li>模块化设计：使用多线程可以将程序分化为多个不同的模块，每个模块都拥有单独的线程来完成任务，<strong>降低了代码之间的耦合度</strong>，更加便于管理和维护；</li><li>改善用户体验：使用多线程可以提高程序的运行速度，在GUI程序中可以确保界面响应灵敏，不会因为一个耗时过大的操作浪费时间</li></ol><p><strong>缺点：</strong></p><ol><li>线程切换和调度开销：线程的切换和调度需要消耗系统资源，过多的线程切换可能会影响程序性能。</li><li>线程安全问题：多个线程访问共享资源时，可能会出现死锁、竞态条件等安全问题。</li><li>调试和测试难度：由于线程之间相互独立，调试和测试多线程程序可能需要特殊的工具和技巧。</li><li>代码可读性差：多线程程序的代码结构可能变得复杂，影响代码的可读性。</li><li>资源消耗：每个线程都需要占用内存空间和系统资源，<strong>过多的线程</strong>会增加系统资源的消耗。</li><li>数据同步问题：在多线程编程中，如果不正确地处理数据同步和互斥访问，可能会导致<strong>数据竞争</strong>和<strong>程序不稳定</strong>。</li></ol><hr><h5 id="3、他应该怎样实现？创建多线程的方式有哪些？这些方法有什么区别？"><a href="#3、他应该怎样实现？创建多线程的方式有哪些？这些方法有什么区别？" class="headerlink" title="3、他应该怎样实现？创建多线程的方式有哪些？这些方法有什么区别？"></a>3、他应该怎样实现？创建多线程的方式有哪些？这些方法有什么区别？</h5><p>可以继承Thread类，或者调用Runnable / Callable接口来实现</p><ul><li><p>继承Thread类：</p><pre class="language-Java"><code class="language-Java">// 继承多线程类
public class TestThread extends Thread{
    @Override
    public void run() {
        // run()函数，多线程执行体
        for (int i = 0; i < 20; i++) {
            System.out.println("i am studying--" + i);
        }
    }

    public static void main(String[] args) {
        //main()函数，为主函数
        TestThread testThread = new TestThread();
        testThread.start();

        for (int i = 0; i < 200; i++) {
            System.out.println("我在学习多线程--" + i);
        }
    }
}
</code></pre></li><li><p>调用Runnable接口：</p><pre class="language-Java"><code class="language-Java">//基础调用方式
public class TestNew {
    public static void main(String[] args) {
        MyThread2 myThread2 = new MyThread2();//调用Runnable接口需要一个代理对象
        new Thread(myThread2).start(); //需要调用Thread.start()启动线程 
    }
}
class MyThread2 implements Runnable{
    @Override
    public void run() {
        System.out.println("这是调用Runnable接口使用线程的方法");
    }
}
</code></pre><pre class="language-Java"><code class="language-Java">import org.apache.commons.io.FileUtils;
import java.io.File;
import java.net.URL;

//多线程下载图片
//调用 Runnable接口
public class TestThread2 implements Runnable{
    private String url;
    private String name;

    public TestThread2(String url, String name) {
        this.url = url;
        this.name = name;
    }


    @Override
    public void run() {
        WebDownLoader webDownLoader = new WebDownLoader();
        webDownLoader.downLoader(url, name);
        System.out.println("正在下载，文件下载名为：" + name);
    }

    public static void main(String[] args) {
        TestThread2 t1 = new TestThread2("https://imga2.5054399.com/upload_pic/2024/2/26/4399_16291960410.jpg","1.jpg");
        TestThread2 t2 = new TestThread2("https://imga2.5054399.com/upload_pic/2024/3/1/4399_17225675210.jpg","2.jpg");
        TestThread2 t3 = new TestThread2("https://imga1.5054399.com/upload_pic/2017/1/24/4399_10181217218.jpg","3.jpg");

        // runnable方法需要 new一个 Thread对象进行
        new Thread(t1).start();
        new Thread(t2).start();
        new Thread(t3).start();
    }
}

//下载器
class WebDownLoader {
    public void downLoader(String url, String name) {
        try {
            FileUtils.copyURLToFile(new URL(url), new File(name));
        }catch (Exception e) {
            System.out.println("IO异常，downLoader方法出现问题："+e);
        }

    }
}
</code></pre></li><li><p>调用callable接口：</p><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestNew</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        FutureTask<span class="token operator">&lt;</span>Object<span class="token operator">></span> futureTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token operator">&lt;</span>Object<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyThread3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>futureTask<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            String s <span class="token operator">=</span> futureTask<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">MyThread3</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token operator">&lt;</span>Object<span class="token operator">></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> Object <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"这是调用callable接口使用线程的方法"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></li></ul><p>三种实现方式的区别：</p><ol><li><p>callable和runnable区别</p><ul><li><p>使用方法不同：</p><ul><li>Runnable接口只有一个 run( ) 方法，该方法不返回任何值，因此无法抛出任何checked Exception。</li><li>Callable接口则有一个 call( ) 方法，它可以返回一个值，并且可以抛出一个checked Exception。</li></ul></li><li><p>返回值不同：</p><ul><li>Runnable的 run( ) 方法没有返回值，只是一个void类型的方法。</li><li>Callable的 call( ) 方法却必须有一个返回值，并且返回值的类型可以通过 **泛型 **进行指定。</li></ul></li><li><p>异常处理不同：</p><ul><li>在Runnable中，我们无法对run()方法抛出的异常进行任何处理。</li><li>但在Callable中，自定义的call()方法可以抛出一个checked Exception，并由其执行者Handler进行捕获并处理。</li></ul></li><li><p>使用场景不同：</p><ul><li><p>Runnable适用于那些不需要返回值，且不会抛出checked Exception的情况，比如简单的打印输出或者修改一些共享的变量。</p></li><li><p>Callable适用于那些需要返回值或者需要抛出checked Exception的情况，比如对某个任务的计算结果进行处理，或者需要进行网络或IO操作等。</p></li><li><p>在Java中，常常使用Callable来实现异步任务的处理，以提高系统的吞吐量和响应速度。</p></li></ul></li></ul><p><strong>注意点：</strong>Callable接口支持返回执行结果，此时需要调用 FutureTask.get() 方法实现，此方法会<strong>阻塞主线程</strong>直到获取 ”将来“ 的结果；当不调用此方法时，主线程不会阻塞！</p></li></ol><hr><h5 id="4、使用多线程的过程中是否会出现问题？会出现哪些问题？应该怎么解决？"><a href="#4、使用多线程的过程中是否会出现问题？会出现哪些问题？应该怎么解决？" class="headerlink" title="4、使用多线程的过程中是否会出现问题？会出现哪些问题？应该怎么解决？"></a>4、使用多线程的过程中是否会出现问题？会出现哪些问题？应该怎么解决？</h5><p>虽然多线程的使用可以带来很多的便利，但同时也会带来一些问题</p><p>下面是一些常见问题的代码案例：</p><ul><li><p>多窗口售卖火车票：</p><pre class="language-Java"><code class="language-Java">//不安全的买票机制
//线程不安全，会出现负数
public class UnsafeBuyTicket {
    public static void main(String[] args) {
        buyTicket buyTicket = new buyTicket();
        new Thread(buyTicket,"苦逼的我").start();
        new Thread(buyTicket,"幸运的你").start();
        new Thread(buyTicket,"天杀的黄牛").start();
    }
}

class buyTicket implements Runnable{
    //票的数量
    private int ticketNums = 20;
    //判断程序停止的条件
    boolean flag = true;

    @Override
    public void run() {
        //抢票
        while (flag) {
            try {
                rubberyTicket();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }

    //抢票的方法
    private void rubberyTicket() throws InterruptedException {
        //首先判断票还在不在
        if (ticketNums <= 0) {
            flag = false;
            return;
        }
        //模拟延时
        Thread.sleep(100);
        //抢票
        System.out.println(Thread.currentThread().getName() + "-->抢到了第" + ticketNums-- + "张票");
    }
}
</code></pre><p>运行结果：</p><p><img src="/medias/loading.gif" data-original="D:\JAVA学习\多线程学习\多线程笔记图片\火车售票运行结果.png"></p><p>我们可以看到上面的运行结果不仅出现了抢到重复的票，甚至出现了负数；</p></li><li><p>银行取钱：</p><pre class="language-Java"><code class="language-Java">//不安全银行取钱
public class UnsafeBank {

    public static void main(String[] args) {
        //账户
        Account account = new Account(100, "结婚基金");

        Drawing you = new Drawing(account, 50, "你");
        Drawing girlFriend = new Drawing(account, 100, "girlFriend");

        you.start();
        girlFriend.start();
    }
}

//规定一个账户
class Account {
    int money; //余额
    String name; // 用户名
    public Account(int money, String name) {
        this.money = money;
        this.name = name;
    }
}

//银行：模拟取款
class Drawing extends Thread{
    //账户
    Account account;
    //取了多少钱
    private int drawingMoney;
    //还剩多少钱
    private int nowMoney;

    public Drawing(Account account,int drawingMoney, String name) {
        super(name);
        this.account = account;
        this.drawingMoney = drawingMoney;
    }

    //synchronized默认锁的是 this
    @Override
    public void run() {
            //取钱之前先看看余额够不够取
            if (account.money - drawingMoney < 0) {
                System.out.println(Thread.currentThread().getName() + "钱不够，取不了");
                return;
            }

            //模拟延时
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            //账户余额的钱 = 账户存款 - 取的钱
            account.money = account.money - drawingMoney;
            //你现在手里的钱 = 手里的钱 + 取的钱
            nowMoney = nowMoney + drawingMoney;

            System.out.println(account.name + "余额为：" + account.money);
            System.out.println(this.getName() + "手里的钱为：" + nowMoney);
    }
}
</code></pre></li></ul><p>运行结果：</p><p><img src="/medias/loading.gif" data-original="D:\JAVA学习\多线程学习\多线程笔记图片\银行取钱运行结果.png"></p><p>通过这个结果我们发现，账户余额也出现了负数的情况；</p><p>这两个demo都出现了一些不合理的情况，比如出现抢到 第 -1张票，或是抢到重复的票，或者是余额剩余 -50元，产生这种情况大的原因是由多线程操作共享资源tickets所导致的线程安全问题。在多个线程在执行售票的任务的时候，由于在售票的代码中访问了同一个成员变量tickets。可是在操作tickets的这些语句中，一个线程操作到其中的一部分代码的时候，CPU切换到其他的线程上开始执行代码。这样就会导致tickets变量中的值被修改的不一致。</p><p><strong>总结多线程的安全问题发生的原因：</strong></p><ol><li><em>首先必须有多线程。</em></li><li>多个线程在操作共享的数据,并且对共享数据有修改。</li><li>本质原因是CPU在处理多个线程的时候，在操作共享数据的多条代码之间进行切换导致的。</li></ol><p><strong>多线程可能会出现的问题总结：</strong></p><ol><li><em>线程安全问题</em>：当多个线程访问同一块共享内存区域时，如果这些访问不是原子的，可能会发生数据的不一致或丢失。这是因为线程可能在访问过程中被暂停或取消，导致对共享资源的未完成操作被其他线程看到已完成的情形。</li><li><em>性能问题</em>：线程的创建和销毁会对系统内存产生较大的开销。如果线程的数量超过了处理器的核心数量，许多线程可能会处于空闲状态，从而浪费系统的资源和影响垃圾回收过程。此外，频繁的线程创建和销毁会影响程序的执行效率。</li><li><em>活跃性问题</em>：死锁是一种常见的并发错误，当两个或更多的线程都在争夺同一个资源，并且它们都需要对方释放这个资源时，会发生死锁。另一种问题是饥饿，这是指某个线程或多个线程因无法获得所需资源而长时间得不到执行的情况。</li><li><em>调度开销</em>：操作系统会根据调度算法为线程分配时间片，以便线程能够有机会执行。这种上下文切换的开销较大，尤其是在线程数量远超过处理器核心数量的场景下。此外，缓存失效也是多线程环境中的一种性能问题，因为线程调度可能导致缓存中的数据不再有效。</li><li><em>协作开销</em>：在多线程环境中，为了确保数据的一致性和安全性，可能需要牺牲一些性能以避免数据冲突和不一致。例如，为了保证线程安全，编译器和CPU可能不会进行某些优化，或者线程之间的通信操作会增加额外的开销。</li></ol><p>既然存在这么多问题，自然会有<strong>解决问题的方法</strong>：</p><ol><li><p>同步代码块：</p><p>说明：我们了解到线程的安全问题其实就是由多个线程同时处理共享资源所导致的,要想解决线程的安全问题,必须保证下面用于处理共享资源的代码在任何时刻只能被一个线程访问。</p><p>为了实现这种限制,Java中提供了同步机制,当多个线程使用同一个共享资源时,可以将处理共享资源的代码放置在一个代码块中,使用Synchronized关键字来修饰.被称作同步代码块.</p><p>Synchronized(锁对象) {</p><p>}</p><ul><li>锁对象是任意的一个对象</li><li>资源操作的所有代码需要被同步</li></ul><p>要想保证线程的安全：需要在操作共享数据的地方，加上线程的同步锁。<br>锁对象的前提条件 :必须要保证 <code>锁对象</code>的唯一性.</p><p>这样做的好处是, 同步方法被所有线程所共享, 方法所在的对象相对于所有线程来说是唯一的, 从而保证了锁的唯一性. 当一个线程执行该方法时, 其它的线程就不能进入到该方法中, 直到这个线程执行完该方法为止, 从而达到了线程同步的效果.</p><p>以抢票为例：给 rubberyTicket()方法添加一个 synchronized关键字</p><p><img src="/medias/loading.gif" data-original="D:\JAVA学习\多线程学习\多线程笔记图片\同步线程方法.png"></p></li></ol><p>​ 运行结果变为正常，不会出现 第0/-1张票，也不会出现多人抢到同一张票的情况</p><p>​ <img src="/medias/loading.gif" data-original="D:\JAVA学习\多线程学习\多线程笔记图片\同步锁之后售票运行结果.png"></p><p><strong>注意</strong>：同步代码块中的锁对象可以是任意类型的对象,但多个线程共享的锁对象必须是唯一的.。<code>任意</code> 说的是共享锁对象的类型， 所以,，锁对象的创建代码不能放在 run() 方法中。否则每个线程运行到 run()方法都会创建一个新对象，这样每个线程都会有一个不同的锁, 每个锁都有自己的标志位. 线程之间便不能产生同步的效果。</p><hr><h5 id="5、什么是高并发？他会导致那些问题？如何解决高并发问题？"><a href="#5、什么是高并发？他会导致那些问题？如何解决高并发问题？" class="headerlink" title="5、什么是高并发？他会导致那些问题？如何解决高并发问题？"></a>5、什么是高并发？他会导致那些问题？如何解决高并发问题？</h5><p>（1）高并发介绍：</p><p>高并发（High Concurrency）通常是指通过设计保证系统能够同时并行处理很多请求。通俗来讲，高并发是指系统在同一时间段内处理大量并发请求的能力。</p><p>（2）可能会导致的问题：</p><ol><li>资源竞争：多个线程同时访问共享的资源，如数据库连接、文件等，可能导致资源竞争问题，包括数据不一致、死锁等。</li><li>线程安全问题：多个线程同时访问共享的变量或对象时，可能会导致数据错误或不一致的问题。</li><li>性能瓶颈：高并发情况下，系统的性能可能会受到限制，导致响应时间延长或系统崩溃。</li></ol><p>（3）解决方法：</p><ol><li>使用线程池：通过线程池来管理线程，控制线程的数量，避免线程创建和销毁的开销，并能限制并发请求数量，避免资源耗尽。</li><li>使用缓存：通过使用缓存技术，将计算结果或数据库查询结果缓存起来，减少对数据库等资源的访问，提高系统的并发处理能力。</li><li>数据库优化：对数据库进行优化，包括索引的设计、查询语句的优化等，提高数据库的并发处理能力。</li><li>使用分布式系统：将系统拆分成多个独立的服务，通过分布式部署来提高系统的并发处理能力。</li><li>使用消息队列：将请求转化为消息，通过消息队列来异步处理请求，减少直接面对高并发带来的压力。</li><li>使用缓存技术：通过使用缓存技术，将计算结果或数据库查询结果缓存起来，减少对数据库等资源的访问，提高系统的并发处理能力。</li></ol><p>以上这些方法并非适用于所有场景，具体的解决方案需要根据具体的业务和系统需求来确定。</p><hr><h5 id="6、死锁是什么？他的产生原因有哪些？有什么解决办法？"><a href="#6、死锁是什么？他的产生原因有哪些？有什么解决办法？" class="headerlink" title="6、死锁是什么？他的产生原因有哪些？有什么解决办法？"></a>6、死锁是什么？他的产生原因有哪些？有什么解决办法？</h5><p>死锁：是指两个或者两个以上的线程在执行的过程中，因争夺资源产生的一种互相等待现象（就是指两个或多个进程持有对方进程所需要的资源，形成僵持）</p><p>例如两个女孩都需要化妆，灰姑娘首先拿到了口红，而白雪公主首先拿到了镜子，但是两人都不愿意让出自己的东西，还想要对方的资源，于是双方相互等待造成死锁，代码如下：</p><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">deathLock1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        makeup girl1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">makeup</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"灰姑娘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        makeup girl2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">makeup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"白雪公主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//启动线程</span>
        girl1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        girl2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//化妆</span>

<span class="token comment" spellcheck="true">//1. 定义一个口红类</span>
<span class="token keyword">class</span> <span class="token class-name">Lipstick</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//2. 定义一个镜子类</span>
<span class="token keyword">class</span> <span class="token class-name">Mirror</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//3. 定义一个执行类并继承 Thread方法</span>
<span class="token keyword">class</span> <span class="token class-name">makeup</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">//要化妆首先要获取装备，需要添加 static否则不会发生死锁</span>
    <span class="token comment" spellcheck="true">//类在 main方法中被 new 了二次，td1和 td2各自分别产生了 o1,o2。</span>
    <span class="token comment" spellcheck="true">//如果没有static，创建的就是各个线程各自对象，就没法在线程之间共享了</span>
    <span class="token keyword">static</span> Lipstick lipstick <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lipstick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> Mirror mirror <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mirror</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//其次要获取执行对象</span>
    <span class="token keyword">int</span> chance<span class="token punctuation">;</span>
    String name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">makeup</span><span class="token punctuation">(</span><span class="token keyword">int</span> chance<span class="token punctuation">,</span> String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>chance <span class="token operator">=</span> chance<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//化妆</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">makingUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//定义一个化妆的方法</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">makingUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>chance <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>lipstick<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// 获取口红的锁</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了口红"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 停止一秒后去拿镜子</span>
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mirror<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// 获取镜子的锁</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了镜子"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mirror<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// 获取镜子的锁</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了镜子"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 停止2秒后去拿口红</span>
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>lipstick<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// 获取口红的锁</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了口红"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>运行结果：</p><p><img src="/medias/loading.gif" data-original="D:\JAVA学习\多线程学习\多线程笔记图片\死锁问题.png"></p><pre class="language-Java"><code class="language-Java">* 产生死锁的必要条件：
* 1. 互斥条件：一个资源每次只能被一个进程使用
* 2. 请求与保持条件：一个进程因请求资源在阻塞时，对已获得的资源不放
* 3. 不剥夺条件：进程已获得资源，在未完成时，不可以剥夺资源
* 4. 循环等待条件：在若干个进程之间形成一种头尾相接的循环等待资源关系。
</code></pre><p>1.</p><p>解决死锁的办法：解决上述条件的一个或多个，就可以解决死锁问题</p><ol><li>避免使用多个锁：当多个线程需要获取多个锁时，可以尝试将多个锁合并为一个锁，或者将一个锁拆分为多个锁，以避免死锁的发生。</li><li>保持锁的顺序一致：当多个线程需要获取多个锁时，确保它们获取锁的顺序是一致的，避免不同线程以不同的顺序获取锁而导致死锁。</li><li>设置获取锁的超时时间：在获取锁时设置一个超时时间，如果在指定的时间内无法获取到锁，则放弃当前获取的锁，等待一段时间后重新尝试获取锁。</li></ol><p>具体代码实现如下：</p><p>（1）使用synchronized关键字：</p><ul><li><p>synchronized修饰的方法会自动获取对象的内置锁（也称为同步锁），只有当前线程能够进入该方法并执行其中的代码。其他线程需要等待当前线程释放锁才能进入该方法。这样就确保了每次只有一个线程能够执行被synchronized修饰的代码段，从而保证了线程的安全性。</p><p>修改后代码如下：</p><pre class="language-java"><code class="language-java"> <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">makingUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>chance <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>lipstick<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// 获取口红的锁</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了口红"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 停止一秒后去拿镜子</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mirror<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// 获取镜子的锁</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了镜子"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mirror<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// 获取镜子的锁</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了镜子"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 停止2秒后去拿口红</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>lipstick<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// 获取口红的锁</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"拿到了口红"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><p>运行结果：</p><p><img src="/medias/loading.gif" data-original="D:\JAVA学习\多线程学习\多线程笔记图片\死锁修改完成后.png"></p><p>可以看到死锁问题已经得到解决。</p></li></ul><p>（2）使用 ReentrantLock 类：</p><ul><li><p>ReentrantLock 提供了更加灵活、功能更强大的锁机制。与synchronized不同，ReentrantLock 支持公平锁和非公平锁两种模式，还可以设置超时等待时间。</p><p>修改后代码如下：</p><pre class="language-java"><code class="language-java"><span class="token comment" spellcheck="true">//定义一个Lock锁</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> ReentrantLock lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 加锁</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ticketNum <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ticketNum<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//解锁</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></li></ul><pre class="language-java"><code class="language-java"><span class="token operator">*</span> <span class="token keyword">synchronized</span> 与 <span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>锁的区别：
<span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">.</span> lock是显式锁，需要手动的开关锁；<span class="token keyword">synchronized</span>是隐式锁，出了作用区域会自动释放
<span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">.</span> lock只有代码块锁；<span class="token keyword">synchronized</span>有代码块锁和方法锁
<span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">.</span> 使用 lock锁，JVM会花费较少的时间来调度线程，性能更好一点。并且具有良好的可扩展性（有更多的子类）
<span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">.</span> 优先使用顺序
<span class="token operator">*</span>    Lock <span class="token operator">></span> 同步代码块（已经进入了方法体，分配了相应的资源）<span class="token operator">></span> 同步方法（在方法体之外）
</code></pre><h5 id="8、三大不安全案例分别是什么？有没有解决办法？"><a href="#8、三大不安全案例分别是什么？有没有解决办法？" class="headerlink" title="8、三大不安全案例分别是什么？有没有解决办法？"></a>8、三大不安全案例分别是什么？有没有解决办法？</h5><p>经典的三大多线程不安全案例分别是：</p><ol><li>竞态条件（Race Condition）：竞态条件指的是多个线程并发执行时，最终的结果取决于线程的执行顺序。当多个线程同时访问和修改共享的数据时，如果执行顺序不确定或者不正确，可能导致数据的不一致性。例如，多个线程同时对同一个计数器进行自增操作，如果没有适当的同步机制，可能导致计数结果错误。</li><li>死锁（Deadlock）：死锁指的是多个线程因为相互等待对方释放资源而无法继续执行的情况。当多个线程同时持有一些共享资源，并且每个线程都在等待其他线程释放它所需要的资源时，就可能发生死锁。如果没有合适的策略来避免死锁或解决死锁，程序将无法继续执行。</li><li>数据竞争（Data Race）：数据竞争指的是多个线程同时访问共享的可变数据，并且至少有一个线程对数据进行写操作，而没有适当的同步机制来保护数据的一致性。当多个线程并发读写共享数据时，可能导致数据损坏或不一致。例如，一个线程正在修改某个对象的属性，而另一个线程同时读取该属性的值，可能读取到的是不一致的结果。</li></ol><p>针对以上三个不安全的问题，相对应的解决方法如下：</p><ol><li>竞态条件（Race Condition）：<ul><li>使用互斥锁（Mutex）或信号量（Semaphore）等同步机制来保护共享数据的访问，确保同一时间只有一个线程能够修改共享数据。</li><li>使用原子操作或原子类型（Atomic Type）来进行数据的读写操作，确保原子性，避免竞态条件的发生。</li><li>使用条件变量（Condition Variable）来进行线程之间的等待和通知，以控制线程的执行顺序。</li></ul></li><li>死锁（Deadlock）：<ul><li>避免循环等待（Circular Wait）的情况，即线程获取资源的顺序应该是一致的，可以通过按照预定的顺序获取资源来避免死锁。</li><li>使用资源分级策略，确保线程按照一定的优先级来获取和释放资源，避免出现所有线程都无法继续执行的情况。</li><li>引入超时机制，当线程等待资源的时间超过一定阈值时，可以主动释放已持有的资源，避免死锁的发生。</li></ul></li><li>数据竞争（Data Race）：<ul><li>使用互斥锁（Mutex）或读写锁（Read-Write Lock）来保护共享数据的读写操作，确保同一时间只有一个线程能够修改共享数据。</li><li>使用原子操作或原子类型（Atomic Type）来进行数据的读写操作，确保原子性，避免数据竞争的发生。</li><li>使用线程局部存储（Thread-Local Storage）来保证每个线程都有自己独立的数据副本，避免共享数据的读写冲突。</li></ul></li></ol><hr><h5 id="9、什么是生产者消费者模式？有那些实现方式？实现方式的优缺点有哪些？这种模式有什么优点？"><a href="#9、什么是生产者消费者模式？有那些实现方式？实现方式的优缺点有哪些？这种模式有什么优点？" class="headerlink" title="9、什么是生产者消费者模式？有那些实现方式？实现方式的优缺点有哪些？这种模式有什么优点？"></a>9、什么是生产者消费者模式？有那些实现方式？实现方式的优缺点有哪些？这种模式有什么优点？</h5><p>（1）什么是生产者消费者模式：</p><p>生产者消费者模式是一种常见的多线程设计模式，用于解决生产者和消费者之间的数据交换和协作问题。在该模式中，生产者负责生成数据并将其放入共享的缓冲区，而消费者则从缓冲区中取出数据进行处理。</p><p>生产者消费者模式的基本思想是将生产者和消费者解耦，使它们能够并发地执行，同时通过共享的缓冲区来进行数据交换，从而提高系统的效率和资源利用率。</p><p>以下是生产者消费者模式的基本组件和流程：</p><ol><li>缓冲区（Buffer）：用于存储生产者生成的数据，供消费者消费。缓冲区可以是一个队列、一个缓冲池或者其他数据结构。</li><li>生产者（Producer）：负责生成数据，并将数据放入缓冲区。生产者可以是一个线程或者多个线程。</li><li>消费者（Consumer）：从缓冲区中取出数据，并进行相应的处理。消费者可以是一个线程或者多个线程。</li></ol><p>它的基本流程如下：</p><ul><li>当缓冲区为空时，消费者等待，直到生产者向缓冲区放入数据。</li><li>当缓冲区满时，生产者等待，直到消费者从缓冲区取出数据。</li><li>生产者生成数据并放入缓冲区。</li><li>消费者从缓冲区取出数据并进行处理。</li></ul><p>（2）管程法和信号灯法都是实现生产者消费者模式的经典方法。</p><ol><li><p>管程法（Monitor）：</p><ul><li>管程是一种高级的同步机制，它封装了共享数据和操作共享数据的方法。在管程中，通过定义条件变量和操作方法来实现对共享数据的访问和同步。</li><li>在生产者消费者模式中，可以使用管程来实现对缓冲区的访问和同步。管程提供了等待和通知的机制，使得生产者和消费者可以在缓冲区满或空的情况下进行等待和唤醒操作，以保证生产者和消费者的正确协作。</li></ul><p>代码如下：</p><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>gaoji<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//测试生产者消费者模型：</span>
<span class="token comment" spellcheck="true">//利用缓存区解决-->管程法</span>
<span class="token comment" spellcheck="true">//生产者，消费者，产品，缓冲区</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestPC</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SynContainer container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SynContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Consumer</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//生产者</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span><span class="token punctuation">{</span>
    SynContainer container<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">Product</span><span class="token punctuation">(</span>SynContainer container<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>container <span class="token operator">=</span> container<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"生产了"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"只鸡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            container<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chicken</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//消费者</span>
<span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span><span class="token punctuation">{</span>
    SynContainer container<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">Consumer</span><span class="token punctuation">(</span>SynContainer synContainer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>container <span class="token operator">=</span> synContainer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"吃掉了"</span> <span class="token operator">+</span> container<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"只鸡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            container<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//产品</span>
<span class="token keyword">class</span> <span class="token class-name">Chicken</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">Chicken</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//缓冲区</span>
<span class="token keyword">class</span> <span class="token class-name">SynContainer</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//需要一个容器的大小</span>
    Chicken<span class="token punctuation">[</span><span class="token punctuation">]</span> chickens <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chicken</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//容器的计数器</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//生产者放入产品</span>
    <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>Chicken chicken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> chickens<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">//如果容器满了，需要等待消费者消费,生产者等待</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"SynContainer区类中的Push方法出现异常-->"</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//如果没有满，则继续放入产品</span>
        chickens<span class="token punctuation">[</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> chicken<span class="token punctuation">;</span>
        count<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//可以通知消费者消费</span>
        <span class="token comment" spellcheck="true">//notifyAll()唤醒正在等待此对象监视器锁的所有线程。</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//消费者消费产品</span>
    <span class="token keyword">synchronized</span> Chicken <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//首先判断是否满足消费条件</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//等待生产者生产，消费者等待</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"SynContainer区类中的Push方法出现异常-->"</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//如果可以消费</span>
        count<span class="token operator">--</span><span class="token punctuation">;</span>
        Chicken chicken <span class="token operator">=</span> chickens<span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//产品用完了，通知生产者生产</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> chicken<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></li><li><p>信号灯法（Semaphore）：</p><ul><li>信号灯是一种计数器，用于控制访问共享资源的线程数量。通过对信号灯的操作，可以实现对线程的同步和互斥。</li><li>在生产者消费者模式中，可以使用信号灯来控制缓冲区的空槽数量或者已填充的数据数量。生产者和消费者在访问缓冲区之前，需要通过对信号灯进行操作来获取相应的许可（P操作），并在访问完毕后释放许可（V操作）。</li></ul></li></ol><p>代码如下：</p><pre class="language-java"><code class="language-java"><span class="token comment" spellcheck="true">//测试生产者消费者 2：信号灯法，标志位解决</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestPC2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Item item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Item</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Actor</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//生产者（演员）</span>
<span class="token keyword">class</span> <span class="token class-name">Actor</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//首先需要一个节目对象</span>
    Item item<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">Actor</span><span class="token punctuation">(</span>Item item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>item <span class="token operator">=</span> item<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//产出节目</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token string">"正在播放电视剧。。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token string">"广告ing..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//消费者（观众）</span>
<span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//首先需要一个节目对象</span>
    Item item<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">Watcher</span><span class="token punctuation">(</span>Item item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>item <span class="token operator">=</span> item<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment" spellcheck="true">//观众只需要消费产品即可</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//产品（节目）</span>
<span class="token keyword">class</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//演员演完了，观众来看 T</span>
    <span class="token comment" spellcheck="true">//观众看完了，演员来演 F</span>
    String voice<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//表演的节目</span>
    <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//演员表演节目</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">perform</span><span class="token punctuation">(</span>String voice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//首先判断是否需要表演</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//如果没有节目，则演员继续表演节目</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"演员表演了："</span> <span class="token operator">+</span> voice<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//表演完了，通知观众观看节目</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>voice <span class="token operator">=</span> voice<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>flag<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 更换一下 flag的状态</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//观众看节目</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//首先判断是否有节目观看</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//无节目，则需暂停，等待演员表演完成</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"观众观看了："</span> <span class="token operator">+</span> voice<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//通知演员表演节目</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>flag<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>（3）两种方法的优缺点：</p><p>管程法的优点：</p><ol><li>封装性好：管程将共享数据和操作共享数据的方法封装在一起，使得代码结构清晰、易于理解和维护。</li><li>简洁明了：通过定义条件变量和操作方法，可以直接表达生产者消费者之间的协作关系，代码逻辑清晰。</li><li>安全性高：管程提供了等待和通知的机制，避免了死锁和竞态条件的发生。</li></ol><p>管程法的缺点：</p><ol><li>语言依赖性：管程法是一种高级的同步机制，需要编程语言或操作系统提供对管程的支持。不是所有编程语言或平台都直接支持管程。</li><li>功能相对局限：管程法主要用于描述共享数据和操作，对于更复杂的同步问题可能不够灵活。</li></ol><p>信号灯法的优点：</p><ol><li>通用性强：信号灯是一种通用的同步机制，可以用于各种不同的同步问题，不仅限于生产者消费者模式。</li><li>可扩展性强：通过对信号灯的计数器进行适当的设置，可以控制线程的并发数量，适应不同的需求。</li><li>灵活性高：信号灯法提供了P操作和V操作，可以在任意位置进行信号量的操作，对于复杂的同步逻辑更加灵活。</li></ol><p>信号灯法的缺点：</p><ol><li>容易出错：使用信号灯需要手动编写P操作和V操作，容易出现错误，例如遗漏或错误的信号量操作。</li><li>可能产生死锁：使用信号灯时，需要谨慎设置信号量的初始值和操作顺序，否则可能导致死锁的发生。</li></ol><p>（4）生产者消费者模式的优缺点：</p><p>优点：</p><ol><li>并发性和吞吐量：生产者消费者模式允许生产者和消费者以不同的速度工作，从而提高系统的并发性和吞吐量。生产者和消费者可以并行执行，充分利用系统资源，提高系统的效率。</li><li>解耦和灵活性：生产者消费者模式将生产者和消费者解耦，使它们能够独立地演化和调整。生产者和消费者可以在不影响对方的情况下进行修改和优化，从而提高系统的灵活性和可维护性。</li><li>缓冲和异步处理：通过引入缓冲区，生产者消费者模式可以平衡生产者和消费者之间的速度差异。生产者可以在缓冲区中存储数据，而消费者可以异步地从缓冲区中取出数据进行处理，提供了更好的流量控制和数据处理能力。</li></ol><p>缺点：</p><ol><li>同步和竞态条件：生产者消费者模式需要合适的同步机制来确保生产者和消费者之间的正确协作。如果同步机制设计不当或实现有误，可能会导致竞态条件、死锁等问题的发生，增加了系统设计和调试的复杂性。</li><li>内存开销：由于需要引入缓冲区来存储数据，生产者消费者模式可能会增加系统的内存开销。缓冲区的大小需要合理设置，以保证系统性能和资源的有效利用，避免过大或过小的缓冲区带来的问题。</li><li>数据一致性：生产者消费者模式需要确保数据的一致性和正确性，特别是在多个生产者和消费者的情况下。需要仔细考虑数据的同步、顺序和处理逻辑，以避免数据丢失、重复或错误的情况发生。</li></ol><p>综上所述，生产者消费者模式在提高并发性、解耦和灵活性方面具有明显的优势，但也需要合理考虑同步机制、内存开销和数据一致性等问题。在实际应用中，需要根据具体的需求和系统特点，综合考虑优缺点来选择是否采用生产者消费者模式。</p><hr><h5 id="11、什么是线程池？他有什么作用？如何实现？线程池大小如何确定？"><a href="#11、什么是线程池？他有什么作用？如何实现？线程池大小如何确定？" class="headerlink" title="11、什么是线程池？他有什么作用？如何实现？线程池大小如何确定？"></a>11、什么是线程池？他有什么作用？如何实现？线程池大小如何确定？</h5><p>线程池是一种用于管理和重用线程的机制。它由一组预先创建的线程组成，这些线程可以被反复使用来执行任务，而不需要频繁地创建和销毁线程。</p><p>线程池的作用：</p><ol><li>提高性能和效率：线程池可以减少线程创建和销毁的开销，避免了频繁创建线程的系统开销。通过重用线程，可以降低线程创建和销毁的时间成本，提高系统的性能和效率。</li><li>提供资源管理和限制：线程池可以限制系统中同时运行的线程数量，从而控制系统的资源使用情况。通过设置线程池的大小和队列容量等参数，可以合理分配系统资源，避免资源耗尽的问题。</li><li>提供任务调度和处理：线程池可以接受并处理任务，通过任务队列和线程调度算法，可以合理地分配和执行任务。线程池可以根据系统的负载情况，自动调整线程数量和任务处理速度，提供灵活的任务调度和处理能力。</li></ol><p>线程池的实现：<br>线程池的实现可以分为以下几个步骤：</p><ol><li>创建线程池对象：创建一个线程池对象，包含线程池的属性和方法。</li><li>初始化线程池：在线程池对象中初始化线程池的大小、线程超时时间、任务队列等参数。</li><li>创建线程：根据线程池的大小，预先创建一定数量的线程，并将它们添加到线程池中。</li><li>接受任务：线程池提供一个任务队列，任务可以通过提交到任务队列中进行排队等待执行。</li><li>任务调度和执行：线程池中的线程从任务队列中获取任务，并执行任务的操作。线程池可以使用合适的调度算法来决定任务的执行顺序和线程的分配方式。</li><li>完成任务：线程执行完任务后，可以继续从任务队列中获取新的任务进行处理，直到线程池关闭或任务队列为空。</li><li>关闭线程池：当不再需要线程池时，可以调用关闭方法来停止线程池的运行，释放资源。</li></ol><p>具体线程池的实现方式可以依赖于编程语言和平台的特性。在许多编程语言中，都提供了线程池的标准库或框架，可以直接使用或进行扩展实现。</p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">Sakura</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://anohimono.github.io/2024/03045.html">https://anohimono.github.io/2024/03045.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">Sakura</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="chip bg-color">多线程</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">多谢大佬赏识，您的鼓励就是我最大的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="/medias/loading.gif" data-original="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="/medias/loading.gif" data-original="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/comment_bg.png) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="/libs/valine/av-min.js"></script><script src="https://unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"xa0Evip1UUNJ5XlYzrmZ5XUC-gzGzoHsz",appKey:"PBzrO9XlhlgX9OjRKHixgZM5",notify:!1,verify:!1,visitor:!0,avatar:"mp",pageSize:"10",lang:"zh-cn",placeholder:"ヾﾉ≧∀≦)o 来呀！快活呀！~",enableQQ:!0,emojiCDN:"//i0.hdslb.com/bfs/emote/",emojiMaps:{tv_doge:"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","tv_打脸":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png","tv_抓狂":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png","tv_抠鼻":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png","tv_斜眼笑":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png","tv_无奈":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png","tv_晕":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png","tv_流汗":"cead1c351ab8d79e9f369605beb90148db0fbed3.png","tv_流泪":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png","tv_流鼻血":"c32d39db2737f89b904ca32700d140a9241b0767.png","tv_点赞":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png","tv_生气":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png","tv_生病":"8b0ec90e6b86771092a498c54f09fc94621c1900.png","tv_疑问":"0793d949b18d7be716078349c202c15ff166f314.png","tv_白眼":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png","tv_皱眉":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png","tv_目瞪口呆":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png","tv_睡着":"8b196675b53af58264f383c50ad0945048290b33.png","tv_笑哭":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png","tv_腼腆":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png","tv_色":"61822c7e9aae5da76475e7892534545336b23a6f.png","tv_调侃":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png","tv_调皮":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png","tv_鄙视":"6e72339f346a692a495b123174b49e4e8e781303.png","tv_闭嘴":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png","tv_难过":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png","tv_馋":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png","tv_鬼脸":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png","tv_黑人问号":"45821a01f51bc867da9edbaa2e070410819a95b2.png","tv_鼓掌":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png"},requiredFields:["nick","mail"]})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2024/03052.html"><div class="card-image"><img src="/medias/loading.gif" data-original="/medias/featureimages/10.jpg" class="responsive-img" alt="JVM学习"> <span class="card-title">JVM学习</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-03-05 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> Sakura</span></div></div><div class="card-action article-tags"><a href="/tags/JVM/"><span class="chip bg-color">JVM</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/2024/013160.html"><div class="card-image"><img src="/medias/loading.gif" data-original="/medias/featureimages/5.jpg" class="responsive-img" alt="MySQL连接错误2003处理方法"> <span class="card-title">MySQL连接错误2003处理方法</span></div></a><div class="card-content article-content"><div class="summary block-with-text"></div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2024-01-31 </span><span class="publish-author"><i class="fas fa-user fa-fw"></i> Sakura</span></div></div><div class="card-action article-tags"><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="chip bg-color">数据库</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){var n,t,o,i;void 0===window.getSelection||(""+(n=window.getSelection())).length<Number.parseInt("120")||(t=document.getElementsByTagName("body")[0],(o=document.createElement("div")).style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"!==n.getRangeAt(0).commonAncestorContainer.nodeName&&"CODE"!==n.getRangeAt(0).commonAncestorContainer.nodeName||(o.innerHTML="<pre>"+o.innerHTML+"</pre>"),i=document.location.href,o.innerHTML+='<br />来源: 十二の博客宇宙<br />文章作者: Sakura<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200))})</script><script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget card" style="background-color:#fff"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h2, h3, h4"});let t=parseInt(.4*$(window).height()-64),e=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>t?e.addClass("toc-fixed"):e.removeClass("toc-fixed")});const n="expanded";let i=$("#toc-aside"),l=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){i.hasClass(n)?(i.removeClass(n).hide(),l.removeClass("l9")):(i.addClass(n).show(),l.addClass("l9"));var e="artDetail",o="prenext-posts";if(0!==(e=$("#"+e)).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#"+o).width(t)}})})</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2022-2024</span> <a href="/about" target="_blank">Sakura</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">89.6k</span> <span id="busuanzi_container_site_pv">&nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp; <span id="busuanzi_value_site_pv" class="white-color"></span> </span><span id="busuanzi_container_site_uv">&nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp; <span id="busuanzi_value_site_uv" class="white-color"></span></span><br><span id="sitetime">Loading ...</span><script>var calcSiteTime=function(){var e=new Date,t="2022",n=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),r=e.getHours(),o=e.getMinutes(),e=e.getSeconds(),s=Date.UTC(t,"11","20","12","8","46"),i=Date.UTC(n,i,a,r,o,e)-s,a=Math.floor(i/31536e6),r=Math.floor(i/864e5-365*a);t===String(n)?(document.getElementById("year").innerHTML=n,o="This site has been running for "+r+" days",o="本站已运行 "+r+" 天",document.getElementById("sitetime").innerHTML=o):(document.getElementById("year").innerHTML=t+" - "+n,e="This site has been running for "+a+" years and "+r+" days",e="本站已运行 "+a+" 年 "+r+" 天",document.getElementById("sitetime").innerHTML=e)};calcSiteTime()</script><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/Anohimono" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:2872508031@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2872508031" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2872508031" data-position="top" data-delay="50"><i class="fab fa-qq"></i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script type="text/javascript">$(function(){!function(t,r,s){"use strict";$.ajax({url:t,dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),t=document.getElementById(r),n=document.getElementById(s);t.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(e.forEach(function(t){var n,e,r,s=!0,i=t.title.trim().toLowerCase(),l=t.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),a=0===(a=t.url).indexOf("/")?t.url:"/"+a,c=-1,u=-1;""!==i&&""!==l&&h.forEach(function(t,e){n=i.indexOf(t),c=l.indexOf(t),n<0&&c<0?s=!1:(c<0&&(c=0),0===e&&(u=c))}),s&&(o+="<li><a href='"+a+"' class='search-result-title'>"+i+"</a>",a=t.content.trim().replace(/<[^>]+>/g,""),0<=u&&(t=u+80,(t=0===(e=(e=u-20)<0?0:e)?100:t)>a.length&&(t=a.length),r=a.substr(e,t),h.forEach(function(t){var e=new RegExp(t,"gi");r=r.replace(e,'<em class="search-keyword">'+t+"</em>")}),o+='<p class="search-result">'+r+"...</p>"),o+="</li>")}),o+="</ul>",n.innerHTML=o)})}})}("/search.xml","searchInput","searchResult")})</script><div class="stars-con"><div id="stars"></div><div id="stars2"></div><div id="stars3"></div></div><script>function switchNightMode(){$('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($("body")),setTimeout(function(){$("body").hasClass("DarkMode")?($("body").removeClass("DarkMode"),localStorage.setItem("isDark","0"),$("#sum-moon-icon").removeClass("fa-sun").addClass("fa-moon")):($("body").addClass("DarkMode"),localStorage.setItem("isDark","1"),$("#sum-moon-icon").addClass("fa-sun").removeClass("fa-moon")),setTimeout(function(){$(".Cuteen_DarkSky").fadeOut(1e3,function(){$(this).remove()})},2e3)})}</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:1;pointer-events:none"></canvas><script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script type="text/javascript" src="/js/fireworks.js"></script><script src="https://ssl.captcha.qq.com/TCaptcha.js"></script><script src="/libs/others/TencentCaptcha.js"></script><button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0],e=(t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}()</script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/koharu.model.json"},display:{position:"right",width:145,height:315},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script><style>[bg-lazy]{background-image:none!important;background-color:#eee!important}</style><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a=c[o],i=function(){c=c.filter(function(t){return a!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(a)};(t=a).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),i()):(e=new Image,n=t.getAttribute("data-original"),e.onload=function(){t.src=n,t.removeAttribute("data-original"),i()},t.src!==n&&(e.src=n))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this)</script></body></html>